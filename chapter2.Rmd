#Regression and model validation

*This work has been a good introduction of using some of the handy commands from the dplyr library.*


#first read the data into memory and access dplyr from the library
lrn14 <- read.table("http://www.helsinki.fi/~kvehkala/JYTmooc/JYTOPKYS3-data.txt", sep="\t", header=TRUE)
library(dplyr)
#explore the structure str() and dimension dim() of the data
str(lrn2014)
#the structure of the data is integers for all variables except the gender, which is a factor of "F" or "M"
dim(lrn2014)
#the dimension of the data is 183 observations of 60 variables


#questions related to deep are a total of 12. These are put as a single column setting the mean of all the #observations as the value.
deep_questions <- c("D03", "D11", "D19", "D27", "D07", "D14", "D22", "D30","D06",  "D15", "D23", "D31")
deep_columns <- select(lrn14, one_of(deep_questions))
lrn14$deep <- rowMeans(deep_columns)

>>>lrn14$deep
  [1] 3.583333 2.916667 3.500000 3.500000 3.666667 4.750000 3.833333 3.250000 4.333333 4.000000 3.583333
 [12] 3.833333 4.250000 3.333333 4.166667 3.083333 3.666667 4.083333 3.500000 4.083333 4.000000 3.916667
 [23] 4.000000 4.000000 3.666667 3.666667 4.416667 3.916667 3.833333 3.750000 3.250000 3.583333 4.916667
 [34] 3.583333 2.916667 3.666667 4.500000 4.083333 3.833333 3.250000 2.333333 3.333333 4.083333 2.916667
 [45] 3.333333 3.833333 3.666667 4.666667 3.750000 3.416667 4.166667 2.916667 4.166667 3.583333 2.833333
 [56] 4.000000 2.916667 3.000000 4.083333 2.916667 3.500000 4.333333 4.250000 3.416667 3.083333 4.583333
 [67] 3.416667 3.416667 3.500000 3.416667 3.583333 1.583333 3.333333 4.333333 4.416667 4.583333 4.833333
 [78] 3.083333 3.000000 4.083333 4.083333 3.750000 3.083333 4.750000 4.250000 4.166667 4.416667 3.833333
 [89] 3.333333 3.416667 3.166667 3.166667 3.833333 4.166667 4.250000 3.833333 3.666667 3.833333 3.833333
[100] 3.833333 3.666667 4.166667 4.333333 4.416667 3.750000 2.666667 4.166667 4.000000 4.000000 4.583333
[111] 3.666667 3.666667 3.833333 2.583333 3.500000 3.083333 4.250000 3.166667 3.083333 4.166667 2.250000
[122] 3.333333 3.083333 2.750000 3.250000 3.750000 4.750000 4.000000 3.583333 4.083333 4.250000 3.416667
[133] 3.083333 3.500000 3.916667 3.666667 4.250000 4.250000 3.833333 4.416667 3.500000 3.583333 3.666667
[144] 4.250000 3.750000 2.083333 4.250000 3.583333 4.000000 3.333333 3.500000 3.166667 3.583333 3.416667
[155] 4.250000 3.250000 4.416667 3.250000 3.916667 3.583333 4.500000 3.583333 3.666667 2.583333 4.166667
[166] 3.250000 3.583333 4.333333 3.916667 2.666667 3.583333 3.083333 3.750000 4.083333 4.166667 4.166667
[177] 3.250000 4.083333 2.916667 3.833333 3.166667 3.416667 4.083333

#questions related to strategic are a total of 8. These are put as a single column setting the mean of all the #observations as the value.
strategic_questions <- c("ST01","ST04","ST09","ST12","ST17","ST20","ST25","ST28")
stra_columns <- select(lrn14, one_of(strategic_questions))
lrn14$stra <- rowMeans(stra_columns)

#questions related to surface are a total of 12. These are put as a single column setting the mean of all the #observations as the value.
surf_questions <- c("SU02","SU05","SU08","SU10","SU13","SU16","SU18","SU21","SU24","SU26","SU29","SU32")
surf_columns <- select(lrn14,one_of(surf_questions))
lrn14$surf <- rowMeans(surf_columns)

#choose the columns that will be kept for the analysis
keep_columns <- c("gender","Age","Attitude", "deep", "stra", "surf", "Points")

#creating new dataset of now 7 variables and 183 observations
learning2014 <- select(lrn14, one_of(keep_columns))

#excluding observations with Points = 0 leaving 166 observations
learning2014 <- filter(learning2014, Points > 0)

#saving the dataset as csv-file in IODS-project
write.csv(learning2014,"C:/Users/Pyrintö/Documents/GitHub/IODS-project/learning2014.csv",row.names = FALSE)

#read data again and check str() and head()
lrn2014 <- read.csv("C:/Users/Pyrintö/Documents/GitHub/IODS-project/learning2014.csv")
str(lrn2014)

>>> str(lrn2014)
'data.frame':	166 obs. of  7 variables:
 $ gender  : Factor w/ 2 levels "F","M": 1 2 1 2 2 1 2 1 2 1 ...
 $ Age     : int  53 55 49 53 49 38 50 37 37 42 ...
 $ Attitude: int  37 31 25 35 37 38 35 29 38 21 ...
 $ deep    : num  3.58 2.92 3.5 3.5 3.67 ...
 $ stra    : num  3.38 2.75 3.62 3.12 3.62 ...
 $ surf    : num  2.58 3.17 2.25 2.25 2.83 ...
 $ Points  : int  25 12 24 10 22 21 21 31 24 26 ...
 
#deep, stra and surf are numeric but since nothing was mentioned about this they weren't changed to integers
head(lrn2014)

>>> head(lrn2014)
  gender Age Attitude     deep  stra     surf Points
1      F  53       37 3.583333 3.375 2.583333     25
2      M  55       31 2.916667 2.750 3.166667     12
3      F  49       25 3.500000 3.625 2.250000     24
4      M  53       35 3.500000 3.125 2.250000     10
5      M  49       37 3.666667 3.625 2.833333     22
6      F  38       38 4.750000 3.625 2.416667     21

